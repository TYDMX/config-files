function main(config) {
  const icons = "https://git.imee.me/https://github.com/Koolson/Qure/raw/master/IconSet/Color/";
  const allProviders = Object.keys(config["proxy-providers"] || {});
  const guonei = ["https://dns.alidns.com/dns-query", "https://doh.pub/dns-query"];
  const guowai = ["https://dns.cloudflare.com/dns-query", "https://dns.google/dns-query"];

  config["dns"] = {
    "enable": true,
    "cache-algorithm": "arc",
    "enhanced-mode": "fake-ip",
    "fake-ip-range": "198.18.0.1/16",
    "respect-rules": true,
    "ipv6": true,
    "default-nameserver": ["223.5.5.5", "119.29.29.29", "system"],
    "nameserver": guowai,
    "direct-nameserver": guonei,
    "proxy-server-nameserver": guonei,
    "fake-ip-filter": [
      "rule-set:è‡ªç”¨fake-ip-filter",
      "geosite:connectivity-check,private",
      "geosite:Google@CN,googlefcm",
      "geosite:cn",
      "geosite:geolocation-cn"
    ],
    "nameserver-policy": {
      "geosite:Google@CN,googlefcm": guowai,
      "geosite:category-games-!cn": guowai,
      "geosite:geolocation-!cn,gfw": guowai
    }
  };


  const jd_proxies = ["ğŸš€ æ•…éšœè½¬ç§»", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡­ğŸ‡°", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¸ğŸ‡¬", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¯ğŸ‡µ", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡ºğŸ‡¸", "ğŸ‡¹ğŸ‡¼ å°æ¹¾ç­–ç•¥", "ğŸ‡°ğŸ‡· éŸ©å›½ç­–ç•¥", "ğŸ‡ªğŸ‡º æ¬§ç›Ÿç­–ç•¥", "ğŸŒ å†·é—¨è‡ªé€‰", "ğŸŒ å…¨éƒ¨èŠ‚ç‚¹", "ğŸ¯ å…¨çƒç›´è¿"];
  const biz_proxies = ["ğŸš€ æ•…éšœè½¬ç§»ğŸ‡­ğŸ‡°", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡ºğŸ‡¸", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¸ğŸ‡¬", "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¯ğŸ‡µ", "ğŸŒ å…¨éƒ¨èŠ‚ç‚¹", "ğŸ¯ å…¨çƒç›´è¿"];
  const fallback_hk = ["ğŸ‡­ğŸ‡° é¦™æ¸¯ç­–ç•¥", "ğŸ‡­ğŸ‡° é¦™æ¸¯è‡ªåŠ¨", "ğŸ‡¸ğŸ‡¬ ç‹®åŸç­–ç•¥", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬ç­–ç•¥", "ğŸ‡ºğŸ‡¸ ç¾å›½ç­–ç•¥", "ğŸ‡ªğŸ‡º æ¬§ç›Ÿç­–ç•¥"];
  const fallback_sg = ["ğŸ‡¸ğŸ‡¬ ç‹®åŸç­–ç•¥", "ğŸ‡¸ğŸ‡¬ ç‹®åŸè‡ªåŠ¨", "ğŸ‡­ğŸ‡° é¦™æ¸¯ç­–ç•¥", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬ç­–ç•¥", "ğŸ‡ºğŸ‡¸ ç¾å›½ç­–ç•¥", "ğŸ‡ªğŸ‡º æ¬§ç›Ÿç­–ç•¥"];
  const fallback_us = ["ğŸ‡ºğŸ‡¸ ç¾å›½ç­–ç•¥", "ğŸ‡ºğŸ‡¸ ç¾å›½è‡ªåŠ¨", "ğŸ‡ªğŸ‡º æ¬§ç›Ÿç­–ç•¥", "ğŸ‡­ğŸ‡° é¦™æ¸¯ç­–ç•¥", "ğŸ‡¸ğŸ‡¬ ç‹®åŸç­–ç•¥", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬ç­–ç•¥"];
  const fallback_jp = ["ğŸ‡¯ğŸ‡µ æ—¥æœ¬ç­–ç•¥", "ğŸ‡¯ğŸ‡µ æ—¥æœ¬è‡ªåŠ¨", "ğŸ‡ºğŸ‡¸ ç¾å›½ç­–ç•¥", "ğŸ‡ªğŸ‡º æ¬§ç›Ÿç­–ç•¥", "ğŸ‡­ğŸ‡° é¦™æ¸¯ç­–ç•¥", "ğŸ‡¸ğŸ‡¬ ç‹®åŸç­–ç•¥"];


  config["proxy-groups"] = [
    { name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©", type: "select", proxies: jd_proxies, icon: icons + "Static.png" },
    { name: "ğŸš€ æ•…éšœè½¬ç§»", type: "select", proxies: biz_proxies, icon: icons + "ULB.png" },

    { name: "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡­ğŸ‡°", type: "fallback", proxies: fallback_hk, hidden: true, interval: 333, lazy: true },
    { name: "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¸ğŸ‡¬", type: "fallback", proxies: fallback_sg, hidden: true, interval: 333, lazy: true },
    { name: "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡ºğŸ‡¸", type: "fallback", proxies: fallback_us, hidden: true, interval: 333, lazy: true },
    { name: "ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¯ğŸ‡µ", type: "fallback", proxies: fallback_jp, hidden: true, interval: 333, lazy: true },

    { name: "ğŸ“¹ è§†é¢‘å¹³å°", type: "select", proxies: biz_proxies, icon: icons + "YouTube.png" },
    { name: "ğŸ“² ç¤¾äº¤å¹³å°", type: "select", proxies: biz_proxies, icon: icons + "Twitter.png" },
    { name: "ğŸ“² ç”µæŠ¥å¹³å°", type: "select", proxies: biz_proxies, icon: icons + "Telegram_X.png" },
    { name: "ğŸ¤– AI", type: "select", proxies: biz_proxies, icon: icons + "AI.png" },
    { name: "ğŸ® game", type: "select", proxies: ["ğŸš€ æ•…éšœè½¬ç§»", "ğŸ¯ å…¨çƒç›´è¿"], icon: icons + "Game.png" },
    { name: "ğŸªŸ Microsoft", type: "select", proxies: ["ğŸ¯ å…¨çƒç›´è¿", ...biz_proxies], icon: icons + "Microsoft.png" },
    { name: "ğŸ‡¬ è°·æ­Œ", type: "select", proxies: ["ğŸš€ æ•…éšœè½¬ç§»"], icon: icons + "Google_Search.png" },

    { name: "ğŸ‘¨ğŸ¿â€ğŸ’» GitHub", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ æ•…éšœè½¬ç§»"], icon: icons + "GitHub.png", interval: 90, hidden: true },
    { name: "ğŸ’¶ PayPal", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ æ•…éšœè½¬ç§»"], icon: icons + "PayPal.png", interval: 90, hidden: true },
    { name: "ğŸ Apple", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], icon: icons + "Apple.png", interval: 90, hidden: true },
    
    { name: "ğŸªœ ä»£ç†åŸŸå", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ èŠ‚ç‚¹é€‰æ‹©"], hidden: true },
    { name: "ğŸŒ è‡ªç”¨ä»£ç†", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ èŠ‚ç‚¹é€‰æ‹©"], hidden: true },
    { name: "â¬†ï¸ è‡ªç”¨ç›´è¿", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "â¬†ï¸ ç›´è¿åŸŸå", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸ”’ ç§æœ‰ç½‘ç»œ", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸ“ˆ æµ‹é€Ÿåœ°å€", type: "load-balance", strategy: "round-robin", use: allProviders, proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true, icon: icons + "Speedtest.png" },
    { name: "ğŸ–¥ï¸ ç›´è¿è½¯ä»¶", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸ–¥ï¸ ç›´è¿æœåŠ¡", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸ–¥ï¸ ä»£ç†è½¯ä»¶", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ æ•…éšœè½¬ç§»"], hidden: true },
    { name: "ğŸš« å¹¿å‘Šæ‹¦æˆª", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš« é˜»æ­¢"], hidden: true },
    { name: "ğŸš« è¿½è¸ªæ‹¦æˆª", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš« é˜»æ­¢"], hidden: true },
    { name: "ğŸ® game@CN", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸ‡¬ è°·æ­Œ@CN", type: "load-balance", strategy: "round-robin", proxies: ["ğŸ¯ å…¨çƒç›´è¿"], hidden: true },
    { name: "ğŸªŸ Bing", type: "load-balance", strategy: "round-robin", proxies: ["ğŸš€ èŠ‚ç‚¹é€‰æ‹©"], hidden: true },

    ...createRegion("ğŸ‡­ğŸ‡° é¦™æ¸¯", "Hong_Kong.png", '^(?=.*(?i)(æ¸¯|ğŸ‡­ğŸ‡°|HK))', '^(?=.*(?i)(æ¸¯|ğŸ‡­ğŸ‡°|HK))(?=.*ğŸ’§)', allProviders, icons),
    ...createRegion("ğŸ‡¸ğŸ‡¬ ç‹®åŸ", "Singapore.png", '^(?=.*(?i)(å¡|ğŸ‡¸ğŸ‡¬|SG))', '^(?=.*(?i)(å¡|ğŸ‡¸ğŸ‡¬|SG))(?=.*ğŸ’§)', allProviders, icons),
    ...createRegion("ğŸ‡¯ğŸ‡µ æ—¥æœ¬", "Japan.png", '^(?=.*(?i)(æ—¥|ğŸ‡¯ğŸ‡µ|JP))', '^(?=.*(?i)(æ—¥|ğŸ‡¯ğŸ‡µ|JP))(?=.*ğŸ’§)', allProviders, icons),
    ...createRegion("ğŸ‡ºğŸ‡¸ ç¾å›½", "United_States.png", '^(?=.*(?i)(ç¾|ğŸ‡ºğŸ‡¸|US))', '^(?=.*(?i)(ç¾|ğŸ‡ºğŸ‡¸|US))(?!.*ğŸ’§)', allProviders, icons),
    ...createRegion("ğŸ‡¹ğŸ‡¼ å°æ¹¾", "Taiwan.png", '^(?=.*(?i)(å°|ğŸ‡¹ğŸ‡¼|TW))', '^(?=.*(?i)(å°|ğŸ‡¹ğŸ‡¼|TW))', allProviders, icons),
    ...createRegion("ğŸ‡°ğŸ‡· éŸ©å›½", "Korea.png", '^(?=.*(?i)(éŸ©|ğŸ‡°ğŸ‡·|KR))', '^(?=.*(?i)(éŸ©|ğŸ‡°ğŸ‡·|KR))', allProviders, icons),
    ...createRegion("ğŸ‡ªğŸ‡º æ¬§ç›Ÿ", "European_Union.png", '^(?=.*(?i)(å¾·|æ³•|è‹±|ğŸ‡ªğŸ‡º))', '^(?=.*(?i)(å¾·|æ³•|è‹±|ğŸ‡ªğŸ‡º))', allProviders, icons),

    { name: "ğŸŒ å†·é—¨è‡ªé€‰", type: "select", use: allProviders, filter: '^(?!.*(?i)(DIRECT|ali|china|tencent|ç»´æŠ¤|å¯ç”¨|ç›´è¿|é˜»æ­¢|ç¾|æ¸¯|å¡|å°|æ–°|æ—¥|éŸ©|å¥¥|æ¯”|ä¿|å…‹ç½—åœ°äºš|å¡|æ·|ä¸¹|çˆ±æ²™|èŠ¬|æ³•|å¾·|å¸Œ|åŒˆ|çˆ±å°”|æ„|æ‹‰|ç«‹|å¢|é©¬å…¶å®ƒ|è·|æ³¢|è‘¡|ç½—|æ–¯æ´›ä¼|æ–¯æ´›æ–‡|è¥¿|ç‘|è‹±|ğŸ‡­ğŸ‡°|ğŸ‡¹ğŸ‡¼|ğŸ‡¸ğŸ‡¬|ğŸ‡¯ğŸ‡µ|ğŸ‡°ğŸ‡·|ğŸ‡ºğŸ‡¸|ğŸ‡¬ğŸ‡§|ğŸ‡¦ğŸ‡¹|ğŸ‡§ğŸ‡ª|ğŸ‡¨ğŸ‡¿|ğŸ‡©ğŸ‡°|ğŸ‡«ğŸ‡®|ğŸ‡«ğŸ‡·|ğŸ‡©ğŸ‡ª|ğŸ‡®ğŸ‡ª|ğŸ‡®ğŸ‡¹|ğŸ‡±ğŸ‡¹|ğŸ‡±ğŸ‡º|ğŸ‡³ğŸ‡±|ğŸ‡µğŸ‡±|ğŸ‡¸ğŸ‡ª|HK|TW|SG|JP|KR|US|GB|CDG|FRA|AMS|MAD|BCN|FCO|MUC|BRU|HKG|TPE|TSA|KHH|SIN|XSP|NRT|HND|KIX|CTS|FUK|JFK|LAX|ORD|ATL|DFW|SFO|MIA|SEA|IAD|LHR|LGW))', proxies: ["ğŸˆšï¸ å‡èŠ‚ç‚¹"], icon: icons + "Europe_Map.png" },
    { name: "ğŸŒ å…¨éƒ¨èŠ‚ç‚¹", type: "select", use: allProviders, filter: '^(?!.*(?i)(DIRECT|ali|china))', proxies: ["ğŸˆšï¸ å‡èŠ‚ç‚¹"], icon: icons + "Clubhouse.png" },
    { name: "ğŸŸ æ¼ç½‘ä¹‹é±¼", type: "select", proxies: ["ğŸš€ èŠ‚ç‚¹é€‰æ‹©", "ğŸ¯ å…¨çƒç›´è¿"], icon: icons + "Final.png" }
  ];

  config["proxies"] = [
    { name: "ğŸ¯ å…¨çƒç›´è¿", type: "direct", udp: true },
    { name: "ğŸˆšï¸ å‡èŠ‚ç‚¹", type: "reject" },
    { name: "ğŸš« é˜»æ­¢", type: "reject" }
  ];


  config["rules"] = [
    "OR,((GEOSITE,private),(GEOIP,private)),ğŸ”’ ç§æœ‰ç½‘ç»œ",
    "OR,((GEOSITE,tracker),(GEOSITE,category-public-tracker)),ğŸš« è¿½è¸ªæ‹¦æˆª",
    "OR,((GEOSITE,category-ads-all),(GEOIP,ad)),ğŸš« å¹¿å‘Šæ‹¦æˆª",
    "PROCESS-NAME,com.samsung.android.packageinstaller,ğŸš« å¹¿å‘Šæ‹¦æˆª",
    "PROCESS-NAME,com.google.android.googlequicksearchbox,ğŸ¤– AI",
    "RULE-SET,è‡ªç”¨ä»£ç†è§„åˆ™,ğŸŒ è‡ªç”¨ä»£ç†",
    "RULE-SET,è‡ªç”¨ç›´è¿è§„åˆ™,â¬†ï¸ è‡ªç”¨ç›´è¿",
    "RULE-SET,è‡ªç”¨ä»£ç†è½¯ä»¶,ğŸ–¥ï¸ ä»£ç†è½¯ä»¶",
    "RULE-SET,è‡ªç”¨ç›´è¿è½¯ä»¶,ğŸ–¥ï¸ ç›´è¿è½¯ä»¶",
    "GEOSITE,ookla-speedtest,ğŸ“ˆ æµ‹é€Ÿåœ°å€",
    "GEOSITE,apple,ğŸ Apple",
    "GEOSITE,category-games-cn,ğŸ® game@CN",
    "OR,((GEOSITE,google@cn),(GEOSITE,googlefcm)),ğŸ‡¬ è°·æ­Œ@CN",
    "GEOSITE,category-games-!cn,ğŸ® game",
    "OR,((GEOSITE,openai),(GEOSITE,google-gemini),(GEOSITE,category-ai-!cn)),ğŸ¤– AI",
    "GEOSITE,spotify,ğŸš€ æ•…éšœè½¬ç§»ğŸ‡¯ğŸ‡µ",
    "GEOSITE,paypal,ğŸ’¶ PayPal",
    "GEOSITE,github,ğŸ‘¨ğŸ¿â€ğŸ’» GitHub",
    "GEOSITE,Bing,ğŸªŸ Bing",
    "OR,((GEOSITE,twitter),(GEOSITE,tiktok),(GEOSITE,Reddit),(GEOSITE,discord)),ğŸ“² ç¤¾äº¤å¹³å°",
    "OR,((GEOSITE,telegram),(GEOIP,telegram)),ğŸ“² ç”µæŠ¥å¹³å°",
    "OR,((GEOSITE,youtube),(GEOSITE,netflix),(GEOSITE,onedrive),(GEOSITE,twitch),(GEOSITE,vk),(GEOSITE,disney),(GEOSITE,biliintl),(GEOSITE,category-porn)),ğŸ“¹ è§†é¢‘å¹³å°",
    "GEOSITE,microsoft,ğŸªŸ Microsoft",
    "OR,((GEOSITE,google),(GEOIP,google)),ğŸ‡¬ è°·æ­Œ",
    "GEOSITE,gfw,ğŸªœ ä»£ç†åŸŸå",
    "GEOSITE,geolocation-!cn,ğŸªœ ä»£ç†åŸŸå",
    "OR,((GEOSITE,cn),(GEOIP,cn)),â¬†ï¸ ç›´è¿åŸŸå",
    "MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼"
  ];

  return config;
}


function createRegion(name, icon, allFilter, pureFilter, providers, iconPath) {
  return [
    { 
      name: `${name}ç­–ç•¥`, 
      type: "select", 
      use: providers, 
      filter: allFilter, 
      proxies: [`${name}è‡ªåŠ¨`, `${name}å‡è¡¡-æ•£åˆ—`, `${name}å‡è¡¡-è½®è¯¢`, "ğŸˆšï¸ å‡èŠ‚ç‚¹"], 
      icon: iconPath + icon 
    },
    { name: `${name}è‡ªåŠ¨`, type: "url-test", use: providers, filter: pureFilter, interval: 333, tolerance: 5, hidden: true },
    { name: `${name}å‡è¡¡-æ•£åˆ—`, type: "load-balance", strategy: "consistent-hashing", use: providers, filter: pureFilter, interval: 366, hidden: true },
    { name: `${name}å‡è¡¡-è½®è¯¢`, type: "load-balance", strategy: "round-robin", use: providers, filter: pureFilter, interval: 90, hidden: true }
  ];
}
